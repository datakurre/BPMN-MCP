<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:error id="Error_System" name="SystemError" errorCode="ERR_SYSTEM" camunda:errorMessage="System failure occurred" />
  <bpmn:message id="Message_Cancel" name="CancelRequest" />
  <bpmn:signal id="Signal_Abort" name="AbortSignal" />
  <bpmn:escalation id="Escalation_Priority" name="PriorityEscalation" escalationCode="ESC_PRIORITY" />
  <bpmn:process id="Process_BoundaryEvents" name="Boundary Events - All Types" isExecutable="true" camunda:historyTimeToLive="P180D">
    <bpmn:startEvent id="Start" name="Process Started">
      <bpmn:outgoing>Flow1</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:userTask id="Task_Timer" name="Long Running Task" camunda:candidateGroups="workers" camunda:dueDate="${dateTime().plusHours(4).toDate()}">
      <bpmn:incoming>Flow1</bpmn:incoming>
      <bpmn:outgoing>FlowA</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:boundaryEvent id="BoundTimer" name="Reminder (1h)" cancelActivity="false" attachedToRef="Task_Timer">
      <bpmn:outgoing>FlowBT</bpmn:outgoing>
      <bpmn:timerEventDefinition id="TD1">
        <bpmn:timeCycle>R3/PT1H</bpmn:timeCycle>
      </bpmn:timerEventDefinition>
    </bpmn:boundaryEvent>
    <bpmn:serviceTask id="Task_Error" name="Call External API" camunda:type="external" camunda:topic="api-call">
      <bpmn:extensionElements>
        <camunda:failedJobRetryTimeCycle>R3/PT5M</camunda:failedJobRetryTimeCycle>
      </bpmn:extensionElements>
      <bpmn:incoming>FlowA</bpmn:incoming>
      <bpmn:outgoing>FlowB</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:boundaryEvent id="BoundError" name="System Error" attachedToRef="Task_Error">
      <bpmn:outgoing>FlowBE</bpmn:outgoing>
      <bpmn:errorEventDefinition id="ED1" errorRef="Error_System" camunda:errorCodeVariable="errorCode" camunda:errorMessageVariable="errorMsg" />
    </bpmn:boundaryEvent>
    <bpmn:userTask id="Task_Message" name="Wait for Approval" camunda:candidateGroups="managers">
      <bpmn:incoming>FlowB</bpmn:incoming>
      <bpmn:outgoing>FlowC</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:boundaryEvent id="BoundMessage" name="Cancel Received" cancelActivity="false" attachedToRef="Task_Message">
      <bpmn:outgoing>FlowBM</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MD1" messageRef="Message_Cancel" />
    </bpmn:boundaryEvent>
    <bpmn:serviceTask id="Task_Signal" name="Process Data" camunda:class="com.example.DataProcessor">
      <bpmn:incoming>FlowC</bpmn:incoming>
      <bpmn:outgoing>FlowD</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:boundaryEvent id="BoundSignal" name="Abort Signal" attachedToRef="Task_Signal">
      <bpmn:outgoing>FlowBS</bpmn:outgoing>
      <bpmn:signalEventDefinition id="SD1" signalRef="Signal_Abort" />
    </bpmn:boundaryEvent>
    <bpmn:userTask id="Task_Escalation" name="Final Review" camunda:candidateGroups="reviewers">
      <bpmn:incoming>FlowD</bpmn:incoming>
      <bpmn:outgoing>FlowE</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:boundaryEvent id="BoundEscalation" name="Priority Escalation" cancelActivity="false" attachedToRef="Task_Escalation">
      <bpmn:outgoing>FlowBEsc</bpmn:outgoing>
      <bpmn:escalationEventDefinition id="EscD1" escalationRef="Escalation_Priority" />
    </bpmn:boundaryEvent>
    <bpmn:sendTask id="SendReminder" name="Send Reminder" camunda:delegateExpression="${reminderSender}">
      <bpmn:incoming>FlowBT</bpmn:incoming>
      <bpmn:outgoing>FlowBT2</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:userTask id="HandleSysError" name="Handle Error" camunda:candidateGroups="support">
      <bpmn:incoming>FlowBE</bpmn:incoming>
      <bpmn:outgoing>FlowBE2</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:serviceTask id="LogCancel" name="Log Cancellation" camunda:class="com.example.CancelLogger">
      <bpmn:incoming>FlowBM</bpmn:incoming>
      <bpmn:outgoing>FlowBM2</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndAbort" name="Aborted">
      <bpmn:incoming>FlowBS</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sendTask id="NotifyManager" name="Notify Manager" camunda:delegateExpression="${managerNotifier}">
      <bpmn:incoming>FlowBEsc</bpmn:incoming>
      <bpmn:outgoing>FlowBEsc2</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:endEvent id="End" name="Completed">
      <bpmn:incoming>FlowE</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="EndReminder" name="Reminder Sent">
      <bpmn:incoming>FlowBT2</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="EndSysError" name="Error Handled">
      <bpmn:incoming>FlowBE2</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="EndCancel" name="Cancellation Logged">
      <bpmn:incoming>FlowBM2</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:endEvent id="EndEscalated" name="Manager Notified">
      <bpmn:incoming>FlowBEsc2</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="Flow1" sourceRef="Start" targetRef="Task_Timer" />
    <bpmn:sequenceFlow id="FlowA" sourceRef="Task_Timer" targetRef="Task_Error" />
    <bpmn:sequenceFlow id="FlowB" sourceRef="Task_Error" targetRef="Task_Message" />
    <bpmn:sequenceFlow id="FlowC" sourceRef="Task_Message" targetRef="Task_Signal" />
    <bpmn:sequenceFlow id="FlowD" sourceRef="Task_Signal" targetRef="Task_Escalation" />
    <bpmn:sequenceFlow id="FlowE" sourceRef="Task_Escalation" targetRef="End" />
    <bpmn:sequenceFlow id="FlowBT" sourceRef="BoundTimer" targetRef="SendReminder" />
    <bpmn:sequenceFlow id="FlowBT2" sourceRef="SendReminder" targetRef="EndReminder" />
    <bpmn:sequenceFlow id="FlowBE" sourceRef="BoundError" targetRef="HandleSysError" />
    <bpmn:sequenceFlow id="FlowBE2" sourceRef="HandleSysError" targetRef="EndSysError" />
    <bpmn:sequenceFlow id="FlowBM" sourceRef="BoundMessage" targetRef="LogCancel" />
    <bpmn:sequenceFlow id="FlowBM2" sourceRef="LogCancel" targetRef="EndCancel" />
    <bpmn:sequenceFlow id="FlowBS" sourceRef="BoundSignal" targetRef="EndAbort" />
    <bpmn:sequenceFlow id="FlowBEsc" sourceRef="BoundEscalation" targetRef="NotifyManager" />
    <bpmn:sequenceFlow id="FlowBEsc2" sourceRef="NotifyManager" targetRef="EndEscalated" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Process_BoundaryEvents">
    <bpmndi:BPMNPlane id="BPMNPlane_Process_BoundaryEvents" bpmnElement="Process_BoundaryEvents">
      <bpmndi:BPMNShape id="Start_di" bpmnElement="Start">
        <dc:Bounds x="192" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="171" y="138" width="79" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Timer_di" bpmnElement="Task_Timer">
        <dc:Bounds x="288" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Error_di" bpmnElement="Task_Error">
        <dc:Bounds x="618" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Message_di" bpmnElement="Task_Message">
        <dc:Bounds x="884" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Signal_di" bpmnElement="Task_Signal">
        <dc:Bounds x="1214" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_Escalation_di" bpmnElement="Task_Escalation">
        <dc:Bounds x="1480" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendReminder_di" bpmnElement="SendReminder">
        <dc:Bounds x="378" y="205" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="HandleSysError_di" bpmnElement="HandleSysError">
        <dc:Bounds x="708" y="205" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="LogCancel_di" bpmnElement="LogCancel">
        <dc:Bounds x="974" y="205" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndAbort_di" bpmnElement="EndAbort">
        <dc:Bounds x="1336" y="227" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1334" y="273" width="39" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="NotifyManager_di" bpmnElement="NotifyManager">
        <dc:Bounds x="1570" y="205" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="End_di" bpmnElement="End">
        <dc:Bounds x="1810" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1801" y="78" width="54" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndReminder_di" bpmnElement="EndReminder">
        <dc:Bounds x="528" y="227" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="509" y="273" width="74" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndSysError_di" bpmnElement="EndSysError">
        <dc:Bounds x="858" y="227" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="841" y="203" width="69" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndCancel_di" bpmnElement="EndCancel">
        <dc:Bounds x="1124" y="227" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1110" y="273" width="64" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEscalated_di" bpmnElement="EndEscalated">
        <dc:Bounds x="1720" y="227" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1696" y="263" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BoundTimer_di" bpmnElement="BoundTimer">
        <dc:Bounds x="320" y="142" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="303" y="178" width="71" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BoundError_di" bpmnElement="BoundError">
        <dc:Bounds x="650" y="142" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="636" y="178" width="65" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BoundMessage_di" bpmnElement="BoundMessage">
        <dc:Bounds x="916" y="142" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="892" y="178" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BoundSignal_di" bpmnElement="BoundSignal">
        <dc:Bounds x="1246" y="142" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1234" y="188" width="60" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BoundEscalation_di" bpmnElement="BoundEscalation">
        <dc:Bounds x="1512" y="142" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1486" y="178" width="89" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow1_di" bpmnElement="Flow1">
        <di:waypoint x="228" y="120" />
        <di:waypoint x="288" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowA_di" bpmnElement="FlowA">
        <di:waypoint x="388" y="120" />
        <di:waypoint x="618" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowB_di" bpmnElement="FlowB">
        <di:waypoint x="718" y="120" />
        <di:waypoint x="884" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowC_di" bpmnElement="FlowC">
        <di:waypoint x="984" y="120" />
        <di:waypoint x="1214" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowD_di" bpmnElement="FlowD">
        <di:waypoint x="1314" y="120" />
        <di:waypoint x="1480" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowE_di" bpmnElement="FlowE">
        <di:waypoint x="1580" y="120" />
        <di:waypoint x="1810" y="120" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBT_di" bpmnElement="FlowBT">
        <di:waypoint x="338" y="178" />
        <di:waypoint x="338" y="245" />
        <di:waypoint x="378" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBT2_di" bpmnElement="FlowBT2">
        <di:waypoint x="478" y="245" />
        <di:waypoint x="528" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBE_di" bpmnElement="FlowBE">
        <di:waypoint x="668" y="178" />
        <di:waypoint x="668" y="245" />
        <di:waypoint x="708" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBE2_di" bpmnElement="FlowBE2">
        <di:waypoint x="808" y="245" />
        <di:waypoint x="858" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBM_di" bpmnElement="FlowBM">
        <di:waypoint x="934" y="178" />
        <di:waypoint x="934" y="245" />
        <di:waypoint x="974" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBM2_di" bpmnElement="FlowBM2">
        <di:waypoint x="1074" y="245" />
        <di:waypoint x="1124" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBS_di" bpmnElement="FlowBS">
        <di:waypoint x="1264" y="178" />
        <di:waypoint x="1264" y="245" />
        <di:waypoint x="1336" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBEsc_di" bpmnElement="FlowBEsc">
        <di:waypoint x="1530" y="178" />
        <di:waypoint x="1530" y="245" />
        <di:waypoint x="1570" y="245" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="FlowBEsc2_di" bpmnElement="FlowBEsc2">
        <di:waypoint x="1670" y="245" />
        <di:waypoint x="1720" y="245" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
